<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="Shortcut icon" href="images/site.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Maverick CRM</title>
    <link rel="stylesheet" type="text/css" href="maverickcrm.css?10">
    <script src="scripts/datepicker.js?"></script>
    <script src="scripts/modelData.js?1"></script>
    <script src="scripts/common.js?10"></script>
    <script src="scripts/dataPopulation.js?16"></script>
    <script src="scripts/maverickcrm.js?17"></script>
    <script src="scripts/tabHandler.js?15"></script>
    <script src="scripts/modelHandler.js?8"></script>

</head>
<body onload="init()">
	<input type="hidden" value="" id="user" data-contact="">
    <table id="menu">
        <tr>
            <td width="4%">
                <select class="cssMenu" id="cmbSearchCustomer" title="Customer list" onchange="setSearchPredicate(this)"></select>                
			</td>
            <td width="4%">
                <select class="cssMenu" title="Project list" id="cmbSearchProject" onchange="setSearchPredicate(this)"></select>
			</td>
            <td width="2%">
                <select class="cssMenu" title="Task Type" id="cmbSearchTaskType" style="display:none" onchange="setSearchPredicate(this)"></select>
				<div id="divSearchTaskTypeParent" style="display:inline-block;outline:none;" onblur="menuHandler(menuData.searchTaskType, 0)">
	            	<img src="images/site.png" id="imgSearchTaskType" title="select Task type" data-state="0" onclick="menuHandler(menuData.searchTaskType, null, false)">
	            	<div id="divSearchTaskType"></div>
            	</div>
            </td>
            <td width="6%">
	            <img src="images/task_status_open.png" id="searchOpenTask" style="border: 1px inset;" data-state="1" title = 'Open tasks' onclick="toggleSearchTaskStatus(this)">
	            <img src="images/task_status_closed.png" id="searchClosedTask"  data-state="4" title = 'Close tasks' onclick="toggleSearchTaskStatus(this)">
	            <img src="images/task_status_all.png" id="searchAllTasks"  data-state="0" title = 'All tasks' onclick="toggleSearchTaskStatus(this)">
            </td>
            <td width="5%">
                <input type="text" class="cssMenu" size="15" title="Title" placeholder="task title" id="txtSearchTitle" onchange="setSearchPredicate(this)" onkeypress="submitOnEnter(event)">            
            </td> 
            <td width="18%">
            	<!-- <span id="lblSearchDueDate"  onclick="toggleSearchDate(this, searchModel.dueDate.dom)">Set due date</span> -->
				<table id="tblSearchDueDate" title="Set due date" style="overflow: visible;position: fixed;z-index: 4;background-color: #fbfbfb;" onblur="datePicker.hide()"></table>				
            	
                <input class="cssMenu" type="date" title="Task Due Date" id="txtSearchDueDate" data-isActive="0" onkeyup="flagToggle(getById('lblSearchDueDate'),this, event)" onblur="toggleSearchDate(getById('lblSearchDueDate'), getById('txtSearchDueDate'))"/>
				<img src="images/menu_reset.png" style="float: right; margin-left:0.3em;" title="Reset search (all open tasks)" id="resetSearch" onmousedown="toggleAsBotton(this)" onmouseup="resetTaskSearch();toggleAsBotton(this)">
                <img src="images/menu_search.png" style="float: right; margin-right:0.3em;" id="searchTask"  title="Search tasks" onmousedown="toggleAsBotton(this)" onmouseup="searchTask(prepareSearchTask());toggleAsBotton(this)">                
            </td> 
            <td width="27%" align="right">            	            	
            	<span id="lblLoggedInContact"></span>
            	<img src="images/logout.png" style="margin-left:0.1em;" id="logout" title="Logout" onmousedown="toggleAsBotton(this)" onmouseup="toggleAsBotton(this); logout()">
            	<img src="images/database.png" style="margin-left:0.1em;" id="showDatabase" title="Show SQL" data-state="0" onclick="toggleDatabase(this)">
            	<select id="cmbDebug" tabIndex="-1" onchange="setDebugModule()" style="width:4em;">
            		<option value=0>DBG</option>
            		<option value=1>customer</option>
            		<option value=2>contact</option>
            		<option value=3>task</option>
            		<option value=4>taskLog</option>
            		<option value=5>relation</option>
            		<option value=6>attachment</option>
            		<option value=7>menu</option>
            		<option value=8>common</option>
            		<option value=9>login</option>
				</select>
            </td>                      
        </tr>
    </table>

	<table style="width: 100%;">
		<tr>
			<td class="cssMessageInfo" id="messageInfo">Ready</td>
		</tr>
	</table>
	
   	<table id="parentTaskList" class="cssFixed">
		<tr>
			<td style="width: 5%;">Type</td>
			<td style="width: 70%; text-align: center;">Title</td>
			<td style="width: 12%;">Due date</td>
			<td style="width: 6%;">Effort</td>
			<td style="width: 10%;">Status</td>
		</tr>
	</table>  
	<br>  
    <table class="cssTaskList">
		<tbody id="taskList">             
        </tbody>     
    </table>
    <hr>

    <table style="width: 100%;">
        <tbody>
		<tr>
			<td width="50%" valign="top">
				<div id="divTaskDetailsTop">
	            	<div id="divMenuTaskTypeParent" style="display:inline-block;outline:none;" onblur="menuHandler(menuData.taskType, 0)">
		            	<img src="images/site.png" id="imgTaskType" title="select Task type" data-state="0" onclick="menuHandler(menuData.taskType, null, true)">
		            	<div id="divMenuTaskType"></div>
	            	</div>				
					<select title="Task Type" id="cmbDetailTaskType" style="display:none;"></select>
					<select title="Task Status" id="cmbDetailStatus" style="display:none;"></select>
					<div id="divMenuTaskStatusParent" style="display:inline-block;outline:none;" onblur="menuHandler(menuData.taskStatus, 0)">
						<img src="images/status/new.png" id="imgTaskStatus" title="New" data-state="0" onclick="menuHandler(menuData.taskStatus ,null, true)">				
		            	<div id="divMenuTaskStatus" onblur="menuHandler(menuData.taskStatus, 0)"></div>
	            	</div>
	            	<select title="Contact for this task(Usually you!)" id="cmbDetailContact" style="margin-bottom: 0.4em;"></select>
					<label for="txtDetailEffort" class="cssFieldLabel">Effort</label>
					<input title="Task effort (in hours/days/months)" type="number" id="txtDetailTaskEffort" min="1" value="1">
					<div id="divMenuEffortUnitParent" style="display:inline-block;outline:none;" onblur="menuHandler(menuData.taskEffortUnit, 0)">
						<img title="hours" id="imgEffortUnit" style="margin: 0em" src="images/effortUnit_hours.png" data-state="0" onmousedown="toggleAsBotton(this)" onmouseup="menuHandler(menuData.taskEffortUnit)" >
						<div id="divMenuEffortUnit" onblur="menuHandler(menuData.taskEffortUnit, 0)">
						</div>
					</div>
	            	<span id="lblTotalEffort" style="width: 4.5em; font-weight: bold; font-size: 0.8em;" title="Total effort for task and child tasks">Total: </span><span style="font-size: small" id="totalTaskEffort" title="Total effort for task and child tasks"></span>
	            	<img id="imgEffortStatus" src="images/state_unknown.png" style="border:0;">
					<label for="txtDetailEffort" style="text-align:center;" class="cssFieldLabel">Due:</label>	            	
	            	<span id="lblDetailDueDate" title="Set due date" class="cssFieldLabel" onclick="toggleSearchDate(this, taskModel.dueDate.dom)">Due Date</span>				
					<input type="date" id="txtDetailDueDate" pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}"  data-isActive="0" onkeydown="flagToggle(taskModel.dueDateLabel.dom,this, event)" onblur="toggleSearchDate(taskModel.dueDateLabel.dom, this)"/>
				</div>
				<textarea title="Task title" id="txtDetailTaskTitle" rows="2" cols="77"></textarea>
				<br>
				<div id="divTaskDetailsBottom">
					<input type="hidden" id="effortUnit" value="1"> 
					<input type="hidden" id="taskId" value="0">
					<img align="right"  style="margin-right:1em;" src="images/save.png" title="Save task" id="imgSaveTask" onmousedown="toggleAsBotton(this)" onmouseup="saveTask(); toggleAsBotton(this)">
					<input type="image" style="margin-right:0.5em;"  src="images/add_project.png" title="Add full project" id="addProject" onmousedown="buttonToggler(this)" onmouseup="buttonToggler(this)">
	            	<input type="image" style="margin-right:0.5em;" src="images/add_child.png" title="Add a child to this task" id="addChildTask" data-parentTask="0" data-state="0" onclick="setChildTask(this)">
					<div id="divMenuNewTaskTypeParent" style="display:inline-block;outline:none;" onblur="menuHandler(menuData.newTaskType, 0)">
		            	<img style="margin-right:0.5em;" src="images/newitem.png" title="Add a single task" id="addTask" data-state="0" onmousedown="buttonToggler(this)" onmouseup="menuHandler(menuData.newTaskType, null, true)">
		            	<div id="divMenuNewTaskType" onblur="menuHandler(menuData.newTaskType, 0)"></div>
	            	</div>
            	</div>
				<hr align="left" style="width:35em;">
				<span class="cssTabSelected" id="TabLog" onclick="setTab(tabEnum.taskLog)">Log</span>
				<span class="cssTab" id="TabRelation" onclick="setTab(tabEnum.relation)">Relation</span>
				<span class="cssTab" id="TabAttachment" onclick="setTab(tabEnum.attachment)">Attachments</span>
				<span class="cssTab" id="TabLinkedCustomer" onclick="setTab(tabEnum.linkedCustomer)">Linked Customers</span>
				<span class="cssTab" id="TabPermission" onclick="setTab(tabEnum.permission)">Permissions</span>
				<hr style="border-style: ridge;margin-top: 0.2em;margin-bottom: 0.2em;">
				<div id="divTaskTab" class="card"></div>				                    
			</td>
			<td valign="top" rowspan="2">			
				<div class="tabCRM">
					<table id="cssConnectionList">
						<tr>
						<td>
							<input type="text" tabIndex="-1" title="Search Case Sensitive" id="txtSearchCustomer" class="cssConnectedList" size="15" onkeyup="searchText('cmbConnectedCustomer', 'txtSearchCustomer', event)">
							<img src="images/filter.png" id="imgFilterCustomer" data-state="0" title="filter on selected task" onclick="toggleFilterCustomers(this)">		
						</td>	
						<td>
							<input type="text" tabIndex="-1" title="Search Case Sensitive" id="txtSearchContact" class="cssConnectedList" size="5" onkeyup="searchText('cmbConnectedContact', 'txtSearchContact', event)">
							<img src="images/filter.png" id="imgFilterContact" data-state="0" title="filter on selected contact" onclick="toggleShowContacts(this)">	
						</td>
							
						</tr>
						<tr>
						<td>
							<select id="cmbConnectedCustomer" tabIndex="-1" size="4" class="cssConnectedList"></select>
						</td>
						<td valign="top">
							<select id="cmbConnectedContact" tabIndex="-1" size="3" class="cssConnectedList"></select>
							<br>
							<span id="divContactCard" class="cssCard card"></span>
						</td>
						</tr>
					</table>
					<span id="tabConnection" class="cssTab" onclick="setTab(tabEnum.connection)">Connections</span>
					<span id="tabTimeline" class="cssTab" onclick="setTab(tabEnum.timeline)">Timeline</span>
					<span id="tabCustomer" class="cssTab" onclick="setTab(tabEnum.customer)">Customers</span>
					<span id="tabLogin" class="cssTab" onclick="setTab(tabEnum.login)">Logins</span>
					
					<hr style="border-style: ridge;margin-top: 0.2em;margin-bottom: 0.2em;z-index: 1;">
	             	<div id="divDataFrame" style="align:right; display:none; font-size:small; float:left; height:12em; width: 26m;z-index: 1;">
	            		<textarea rows="5" cols="85" id="txtSQL">select * from task</textarea>
	            		<br>
	            		<img src="images/add_right.png" id="execSQL" title="Execute" onmousedown="toggleAsBotton(this)" onmouseup="toggleAsBotton(this); executeSQL()">
	            		<div style=" position:relative; overflow-y: scroll; height:10em">
		            		<table>
		            			<thead id="resultHeader" style="font-size:x-small;width:100vw;"></thead>
		            			<tbody id="resultBody" style="background-image: url('images/textBackground_no_num.jpg');"></tbody>
		            		</table>	            		
	            		</div>
	            	</div>	
					<div id="divCRM" class="card"></div>
				</div>
			</td>
		</tr>           
        </tbody>
    </table>
</body>
</html>